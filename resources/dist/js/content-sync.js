function l(s,t,e,a,c,i,n,r){var o=typeof s=="function"?s.options:s;return t&&(o.render=t,o.staticRenderFns=e,o._compiled=!0),{exports:s,options:o}}const u={props:{value:{type:String,default:"collections"}}};var d=function(){var t=this,e=t._self._c;return e("select",{staticClass:"cs-select",domProps:{value:t.value},on:{input:function(a){return t.$emit("input",a.target.value)}}},[e("option",{attrs:{value:"collections"}},[t._v("Collections")]),e("option",{attrs:{value:"taxonomies"}},[t._v("Taxonomies")]),e("option",{attrs:{value:"navigation"}},[t._v("Navigation")]),e("option",{attrs:{value:"globals"}},[t._v("Globals")]),e("option",{attrs:{value:"assets"}},[t._v("Assets")])])},v=[],f=l(u,d,v);const m=f.exports;async function p(s){return(await fetch(`/cp/content-sync/options?type=${encodeURIComponent(s)}`,{headers:{"X-CSRF-TOKEN":Statamic.$config.get("csrfToken")}})).json()}async function _(s){return(await fetch("/cp/content-sync/export",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":Statamic.$config.get("csrfToken")},body:JSON.stringify(s)})).json()}async function h(s){const t=new FormData;return t.append("file",s),(await fetch("/cp/content-sync/import/preview",{method:"POST",headers:{"X-CSRF-TOKEN":Statamic.$config.get("csrfToken")},body:t})).json()}async function y(s){return(await fetch("/cp/content-sync/import/commit",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":Statamic.$config.get("csrfToken")},body:JSON.stringify(s)})).json()}const g={props:{type:{type:String,required:!0},value:{type:Array,default:()=>[]}},data(){return{options:[],q:""}},computed:{label(){return{collections:"Collections",taxonomies:"Taxonomies",navigation:"Navigation",globals:"Globals",assets:"Asset Containers"}[this.type]||"Items"},filtered(){const s=this.q.toLowerCase();return this.options.filter(t=>t.toLowerCase().includes(s))}},watch:{type:{immediate:!0,async handler(s){this.options=await p(s),this.$emit("input",[]),this.q=""}}},methods:{onChange(s){this.$emit("input",Array.from(s.target.selectedOptions).map(t=>t.value))},selectAll(){this.$emit("input",[...this.filtered])},clearAll(){this.$emit("input",[])}}};var b=function(){var t=this,e=t._self._c;return e("div",[e("label",{staticClass:"cs-label"},[t._v("Select "+t._s(t.label))]),e("div",{staticClass:"flex gap-2"},[e("div",{staticClass:"flex-1"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.q,expression:"q"}],staticClass:"cs-input",attrs:{placeholder:"Search…"},domProps:{value:t.q},on:{input:function(a){a.target.composing||(t.q=a.target.value)}}}),e("select",{staticClass:"cs-select mt-2",attrs:{multiple:"",size:8},domProps:{value:t.value},on:{change:t.onChange}},t._l(t.filtered,function(a){return e("option",{key:a,domProps:{value:a}},[t._v(t._s(a))])}),0)]),e("div",{staticClass:"w-36 space-y-2"},[e("button",{staticClass:"cs-btn ghost w-full",on:{click:function(a){return a.preventDefault(),t.selectAll.apply(null,arguments)}}},[t._v("Select All")]),e("button",{staticClass:"cs-btn ghost w-full",on:{click:function(a){return a.preventDefault(),t.clearAll.apply(null,arguments)}}},[t._v("Clear")])])])])},C=[],w=l(g,b,C);const x=w.exports,S={components:{TypePicker:m,MultiSelect:x},data(){return{type:"collections",handles:[],allOptions:[],search:"",sitesRaw:"",since:"",out:"export.json",busy:!1,result:null}},computed:{prettyType(){return{collections:"Collections",taxonomies:"Taxonomies",navigation:"Navigation",globals:"Globals",assets:"Asset Containers"}[this.type]},filteredOptions(){const s=(this.search||"").toLowerCase();return this.allOptions.filter(t=>t.toLowerCase().includes(s))}},watch:{async type(s){this.allOptions=await p(s),this.handles=[],this.search=""}},created(){this.type="collections"},methods:{selectAllHandles(){this.handles=[...this.filteredOptions]},async runExport(){this.busy=!0;try{const s={type:this.type,handles:this.handles,sites:this.sitesRaw?this.sitesRaw.split(",").map(t=>t.trim()).filter(Boolean):[],since:this.since||null,out:this.out};this.result=await _(s)}finally{this.busy=!1}}}};var $=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cs-card p-6 space-y-5"},[e("div",{staticClass:"flex items-start justify-between flex-wrap gap-4"},[t._m(0),t.handles.length===0&&t.allOptions.length?e("button",{staticClass:"cs-btn ghost",on:{click:t.selectAllHandles}},[t._v(" Select All Handles ")]):t._e()]),e("div",{staticClass:"cs-grid-2"},[e("div",[e("label",{staticClass:"cs-label"},[t._v("Type")]),e("TypePicker",{model:{value:t.type,callback:function(a){t.type=a},expression:"type"}})],1),e("div",[e("label",{staticClass:"cs-label"},[t._v("Since (optional ISO8601)")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.since,expression:"since"}],staticClass:"cs-input",attrs:{placeholder:"2025-01-01T00:00:00+03:00"},domProps:{value:t.since},on:{input:function(a){a.target.composing||(t.since=a.target.value)}}})])]),e("div",{staticClass:"cs-grid-2"},[e("div",[e("label",{staticClass:"cs-label"},[t._v("Select "+t._s(t.prettyType))]),e("div",{staticClass:"flex gap-2"},[e("div",{staticClass:"flex-1"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.search,expression:"search"}],staticClass:"cs-input",attrs:{placeholder:"Search…"},domProps:{value:t.search},on:{input:function(a){a.target.composing||(t.search=a.target.value)}}}),e("select",{directives:[{name:"model",rawName:"v-model",value:t.handles,expression:"handles"}],staticClass:"cs-select mt-2",attrs:{multiple:"",size:8},on:{change:function(a){var c=Array.prototype.filter.call(a.target.options,function(i){return i.selected}).map(function(i){var n="_value"in i?i._value:i.value;return n});t.handles=a.target.multiple?c:c[0]}}},t._l(t.filteredOptions,function(a){return e("option",{key:a,domProps:{value:a}},[t._v(t._s(a))])}),0)]),e("div",{staticClass:"w-36 space-y-2"},[e("button",{staticClass:"cs-btn ghost w-full",on:{click:function(a){return a.preventDefault(),t.selectAllHandles.apply(null,arguments)}}},[t._v("Select All")]),e("button",{staticClass:"cs-btn ghost w-full",on:{click:function(a){a.preventDefault(),t.handles=[]}}},[t._v("Clear")])])])]),e("div",{staticClass:"cs-grid-2"},[e("div",[e("label",{staticClass:"cs-label"},[t._v("Sites (optional, comma separated)")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.sitesRaw,expression:"sitesRaw"}],staticClass:"cs-input",attrs:{placeholder:"english,arabic"},domProps:{value:t.sitesRaw},on:{input:function(a){a.target.composing||(t.sitesRaw=a.target.value)}}})]),e("div",[e("label",{staticClass:"cs-label"},[t._v("Out filename")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.out,expression:"out"}],staticClass:"cs-input",attrs:{placeholder:"my-export.json"},domProps:{value:t.out},on:{input:function(a){a.target.composing||(t.out=a.target.value)}}})]),e("div",{staticClass:"col-span-2"},[e("button",{staticClass:"cs-btn primary",attrs:{disabled:t.busy},on:{click:t.runExport}},[t._v(" "+t._s(t.busy?"Exporting…":"Export")+" ")]),t.result?e("span",{staticClass:"ml-3 cs-subtle"},[t._v("Exported "),e("b",[t._v(t._s(t.result.count))]),t._v(" → "),e("code",[t._v(t._s(t.result.path))])]):t._e()])])])])},k=[function(){var s=this,t=s._self._c;return t("div",[t("div",{staticClass:"cs-title"},[s._v("Export")]),t("div",{staticClass:"cs-subtle"},[s._v("Choose a type, filter handles & sites, then export to JSON.")])])}],O=l(S,$,k);const T=O.exports,P={props:{diff:{type:Object,required:!0}},computed:{current(){const s={};return Object.entries(this.diff).forEach(([t,e])=>s[t]=e.current),s},incoming(){const s={};return Object.entries(this.diff).forEach(([t,e])=>s[t]=e.incoming),s}},methods:{pretty(s){return JSON.stringify(s,null,2)}}};var j=function(){var t=this,e=t._self._c;return e("div",{staticClass:"mt-4 grid gap-3",staticStyle:{"grid-template-columns":"1fr 1fr"}},[e("div",[e("div",{staticClass:"font-semibold mb-1 text-slate-800"},[t._v("Current")]),e("pre",{staticClass:"cs-pre"},[t._v(t._s(t.pretty(t.current)))])]),e("div",[e("div",{staticClass:"font-semibold mb-1 text-slate-800"},[t._v("Incoming")]),e("pre",{staticClass:"cs-pre"},[t._v(t._s(t.pretty(t.incoming)))])])])},A=[],N=l(P,j,A);const R=N.exports,F={components:{DiffViewer:R},data(){return{file:null,busy:!1,diffs:null,decisions:{},committing:!1}},methods:{onFile(s){this.file=s.target.files[0],this.diffs=null,this.decisions={}},badgeClass(s){return s==="create"?"green":s==="update"?"amber":"gray"},async preview(){if(this.file){this.busy=!0;try{const s=await h(this.file);this.diffs=s,this.decisions=Object.fromEntries(s.diffs.map(t=>[t.key,"incoming"]))}finally{this.busy=!1}}},async commit(){this.committing=!0;try{const s={type:this.diffs.type,decisions:this.diffs.diffs.map(e=>({key:e.key,action:this.decisions[e.key],incoming:e.incoming}))},t=await y(s);Statamic.$toast.success(`Updated ${t.results.updated}, Created ${t.results.created}, Skipped ${t.results.skipped}`)}finally{this.committing=!1}}}};var E=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cs-card p-6 space-y-5"},[e("div",{staticClass:"flex items-start justify-between flex-wrap gap-4"},[t._m(0),e("div",[e("input",{attrs:{type:"file",accept:"application/json,.json"},on:{change:t.onFile}}),e("button",{staticClass:"cs-btn ghost ml-2",attrs:{disabled:!t.file||t.busy},on:{click:t.preview}},[t._v(t._s(t.busy?"Analyzing…":"Preview"))])])]),t.diffs?e("div",{staticClass:"space-y-4"},[e("div",{staticClass:"cs-subtle"},[t._v("Preview ("+t._s(t.diffs.diffs.length)+" items)")]),t._l(t.diffs.diffs,function(a){return e("div",{key:a.key,staticClass:"p-4 rounded-xl border border-gray-200 bg-white"},[e("div",{staticClass:"flex items-center justify-between"},[e("div",{staticClass:"font-semibold text-slate-900"},[t._v(" "+t._s(a.key)+" "),e("span",{staticClass:"cs-badge ml-2",class:t.badgeClass(a.status)},[t._v(t._s(a.status))])]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.decisions[a.key],expression:"decisions[item.key]"}],staticClass:"cs-select w-44",on:{change:function(c){var i=Array.prototype.filter.call(c.target.options,function(n){return n.selected}).map(function(n){var r="_value"in n?n._value:n.value;return r});t.$set(t.decisions,a.key,c.target.multiple?i:i[0])}}},[e("option",{attrs:{value:"incoming"}},[t._v("Accept incoming")]),e("option",{attrs:{value:"current"}},[t._v("Keep current")])])]),e("DiffViewer",{attrs:{diff:a.diff}})],1)}),e("div",{staticClass:"pt-2"},[e("button",{staticClass:"cs-btn primary",attrs:{disabled:t.committing},on:{click:t.commit}},[t._v(" "+t._s(t.committing?"Committing…":"Complete Import")+" ")])])],2):t._e()])},I=[function(){var s=this,t=s._self._c;return t("div",[t("div",{staticClass:"cs-title"},[s._v("Import")]),t("div",{staticClass:"cs-subtle"},[s._v("Upload an export JSON, review the diff, choose what to keep, then apply.")])])}],q=l(F,E,I);const D=q.exports,J={components:{ExportPanel:T,ImportPanel:D},data(){return{tab:"export"}}};var K=function(){var t=this,e=t._self._c;return e("div",{staticClass:"space-y-6"},[e("div",{staticClass:"cs-card p-4 flex items-center justify-between"},[e("div",{staticClass:"cs-title"},[t._v("Content Sync")]),e("div",{staticClass:"cs-tabbar"},[e("button",{staticClass:"cs-tab",class:{active:t.tab==="export"},on:{click:function(a){t.tab="export"}}},[t._v("Export")]),e("button",{staticClass:"cs-tab",class:{active:t.tab==="import"},on:{click:function(a){t.tab="import"}}},[t._v("Import")])])]),t.tab==="export"?e("ExportPanel"):e("ImportPanel")],1)},z=[],H=l(J,K,z);const L=H.exports;Statamic.booting(()=>{Statamic.$components.register("content-sync-utility",L)});
